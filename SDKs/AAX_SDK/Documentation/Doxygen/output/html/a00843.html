<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AAX SDK: The Avid Component Framework (ACF)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="aaxdoxy.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pure-purple-avid-logo-solid.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AAX SDK
   &#160;<span id="projectnumber">2.4.0</span>
   </div>
   <div id="projectbrief">Avid Audio Extensions Development Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li class="current"><a href="modules.html"><span>Manual</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="pages.html"><span>Lists</span></a></li>
      <li><a href="usergroup0.html"><span>Support</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Documents</a>  </div>
  <div class="headertitle">
<div class="title">The Avid Component Framework (ACF)<div class="ingroups"><a class="el" href="a00808.html">AAX SDK Manual</a> &raquo; <a class="el" href="a00833.html">Additional Topics</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader"> </h2>
<p>How the AAX C++ interfaces work. </p>
<p>The objects and interfaces in AAX are based on the Avid Component Framework (ACF). The ACF is Avid’s implementation of COM, and is the framework that AAX, as well as AVX (Avid Video Externsions) plug-ins are built on.</p>
<p>ACF can be considered an implementation detail of the AAX SDK; the SDK is written to protect plug-in developers from the intricacies of ACF, and it is not necessary to understand ACF or COM in order to use the SDK.</p>
<h1><a class="anchor" id="details"></a>
More details</h1>
<p>As in COM, ACF draws a distinction between the concept of an object and the concept of an interface. An object is treated as a "black box" of code, whereas an interface is a class of pure virtual methods that allows one to access the functionality inside the object. An object in ACF is represented by the <a class="el" href="a01689.html">IACFUnknown</a> interface, which is binary compatible with the COM class IUnknown. (Likewise, <a class="el" href="a01689.html">IACFUnknown</a> follows the same reference counting rules as IUnknown objects.) This interface allows a client to get pointers to other interfaces on a given object using the <a class="el" href="a01689.html#a8b7f0ae9c78d007ca76aa462ebe53135">QueryInterface()</a> method.</p>
<p>Reference counting is an important aspect of both COM and ACF. Simply put, reference counting is the practice of tracking all references to an object, so that a program can determine when the object can safely be deleted. The AAX SDK library handles this reference counting behind the scenes, so plug-ins that call into the SDK library to manage their component interfaces will not leak references.</p>
<p>Many additional resources can be found both online and print that cover COM and reference counting in greater detail.</p>
<h1><a class="anchor" id="acf_in_aax"></a>
ACF interfaces in AAX</h1>
<p>The binary interface between an AAX plug-in and host is defined by a series of ACF interfaces. Each of these interfaces inherits from <a class="el" href="a01689.html">IACFUnknown</a>. The implementation of each ACF interface typically uses <code>CACFUnknown</code>, a utility class that provides basic reference counting and additional fundamental ACF details to satisfy <a class="el" href="a01689.html">IACFUnknown</a>.</p>
<p>These ACF interfaces may be implemented by either the AAX plug-in or the host. The host retains a reference to each interface that is implemented by the plug-in in order to call methods on the plug-in's implementation. Correspondingly, the plug-in retains references to various interfaces that are implemented by the host, and may call host methods via these interfaces.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_aax_acf_versioning_plug-in.svg" width="506" height="619"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
ACF interfaces: AAX_IACFEffectParameters and AAX_IACFController</div>
</div>
</p>
<p>The figure above demonstrates this design: the plug-in implements <a class="el" href="a01953.html">AAX_IACFEffectParameters</a> directly, and retains a reference to an <a class="el" href="a01917.html">AAX_IACFController</a> that is implemented by the host.</p>
<p>In order to implement <a class="el" href="a01953.html">AAX_IACFEffectParameters</a>, <a class="el" href="a02113.html">AAX_IEffectParameters</a> inherits from <code>CACFUnknown</code> and implements <a class="el" href="a01689.html#a8b7f0ae9c78d007ca76aa462ebe53135">QueryInterface()</a> to ensure that the <a class="el" href="a01689.html">IACFUnknown</a> interface is implemented. The rest of the implementation of <a class="el" href="a01953.html">AAX_IACFEffectParameters</a> is contained in <a class="el" href="a01761.html">AAX_CEffectParameters</a> and the plug-in's custom data model class.</p>
<p>The reference to <a class="el" href="a01917.html">AAX_IACFController</a> is managed by a versioned implementation class. For more information about this design, see below.</p>
<h1><a class="anchor" id="using_acf"></a>
Using ACF interfaces</h1>
<p>Depending on where an interface is implemented, there are two specific ways to acquire a reference to the underlying AAX object from an <a class="el" href="a01689.html">IACFUnknown</a> pointer:</p>
<ul>
<li><a class="el" href="a00843.html#using_acf_host_provided_interfaces">Host-provided interfaces</a> </li>
<li><a class="el" href="a00843.html#using_acf_plug_in_interfaces">Plug-in interfaces</a></li>
</ul>
<h2><a class="anchor" id="using_acf_host_provided_interfaces"></a>
Host-provided interfaces</h2>
<p>Interfaces that are managed by the host must be carefully version-controlled in order to maintain compatibility with many different host versions. The AAX SDK includes "AAX_V" classes to handle this versioning. AAX_V classes are concrete classes that query the host for the correct version of the requested interface. These classes can also handle re-routing deprecated calls and other complicated versioning logic.</p>
<p>To create an AAX_V object, pass an <a class="el" href="a01689.html" title="COM compatible IUnknown C++ interface.">IACFUnknown</a> pointer to the underlying host-managed interface in to the AAX_V class' constructor. ACF reference counting is handled automatically by the object's construction and destruction routines, so no additional calls are necessary to acquire and release the reference.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00713.html">AAX_VController.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> SomeFunction (<a class="code" href="a01689.html">IACFUnknown</a> * inController)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// When object is created, a reference is acquired</span></div>
<div class="line">    <a class="code" href="a02197.html">AAX_VController</a> theController (inController);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// When object goes out of scope, the reference is released</span></div>
<div class="line">}</div>
<div class="ttc" id="aa00713_html"><div class="ttname"><a href="a00713.html">AAX_VController.h</a></div><div class="ttdoc">Version-managed concrete Controller class.</div></div>
<div class="ttc" id="aa01689_html"><div class="ttname"><a href="a01689.html">IACFUnknown</a></div><div class="ttdoc">COM compatible IUnknown C++ interface.</div><div class="ttdef"><b>Definition:</b> AAX_ACFInterface.doxygen:248</div></div>
<div class="ttc" id="aa02197_html"><div class="ttname"><a href="a02197.html">AAX_VController</a></div><div class="ttdoc">Version-managed concrete Controller class.</div><div class="ttdef"><b>Definition:</b> AAX_VController.h:56</div></div>
</div><!-- fragment --><h2><a class="anchor" id="using_acf_plug_in_interfaces"></a>
Plug-in interfaces</h2>
<p>Interfaces to objects that are owned by the plug-in always have a known version and therefore do not require AAX_V object management. Instead, these interfaces must be acquired and released directly using ACF.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00698.html">AAX_UIDs.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00407.html">AAX_Assert.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00611.html">AAX_IEffectParameters.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;acfunknown.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> SomeFunction (<a class="code" href="a01689.html">IACFUnknown</a> * inController)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// When interface is queried, a reference is acquired</span></div>
<div class="line">    <span class="keywordflow">if</span> ( inController )</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="a02113.html">AAX_IEffectParameters</a>* myEffectParameters = NULL;</div>
<div class="line">        ACFRESULT acfErr = ACF_OK;</div>
<div class="line">        acfErr = inController-&gt;<a class="code" href="a01689.html#a8b7f0ae9c78d007ca76aa462ebe53135">QueryInterface</a>(</div>
<div class="line">            <a class="code" href="a00698.html#a8379d320e9eabb19428d005fb6499f88">IID_IAAXEffectParametersV1</a>,</div>
<div class="line">            (<span class="keywordtype">void</span> **)&amp;myEffectParameters);</div>
<div class="line">        </div>
<div class="line">        <a class="code" href="a00407.html#a168ee44fd7a5485ab50160db36fb2988">AAX_ASSERT</a>(ACFSUCCEEDED(acfErr));</div>
<div class="line">    }   </div>
<div class="line">    </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">// The reference must be explicitly released when finished</span></div>
<div class="line">    <span class="keywordflow">if</span> (myEffectParameters)</div>
<div class="line">    {</div>
<div class="line">        myEffectParameters-&gt;Release();</div>
<div class="line">        myEffectParameters = NULL;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aa00407_html"><div class="ttname"><a href="a00407.html">AAX_Assert.h</a></div><div class="ttdoc">Declarations for cross-platform AAX_ASSERT, AAX_TRACE and related facilities.</div></div>
<div class="ttc" id="aa00407_html_a168ee44fd7a5485ab50160db36fb2988"><div class="ttname"><a href="a00407.html#a168ee44fd7a5485ab50160db36fb2988">AAX_ASSERT</a></div><div class="ttdeci">#define AAX_ASSERT(condition)</div><div class="ttdoc">Asserts that a condition is true and logs an error if the condition is false.</div><div class="ttdef"><b>Definition:</b> AAX_Assert.h:268</div></div>
<div class="ttc" id="aa00611_html"><div class="ttname"><a href="a00611.html">AAX_IEffectParameters.h</a></div><div class="ttdoc">The interface for an AAX Plug-in's data model.</div></div>
<div class="ttc" id="aa00698_html"><div class="ttname"><a href="a00698.html">AAX_UIDs.h</a></div><div class="ttdoc">Unique identifiers for AAX/ACF interfaces.</div></div>
<div class="ttc" id="aa00698_html_a8379d320e9eabb19428d005fb6499f88"><div class="ttname"><a href="a00698.html#a8379d320e9eabb19428d005fb6499f88">IID_IAAXEffectParametersV1</a></div><div class="ttdeci">const acfIID IID_IAAXEffectParametersV1</div><div class="ttdoc">ACF interface ID for AAX_IACFEffectParameters.</div><div class="ttdef"><b>Definition:</b> AAX_UIDs.h:158</div></div>
<div class="ttc" id="aa01689_html_a8b7f0ae9c78d007ca76aa462ebe53135"><div class="ttname"><a href="a01689.html#a8b7f0ae9c78d007ca76aa462ebe53135">IACFUnknown::QueryInterface</a></div><div class="ttdeci">virtual BEGIN_ACFINTERFACE ACFRESULT ACFMETHODCALLTYPE QueryInterface(const acfIID &amp;iid, void **ppOut)=0</div><div class="ttdoc">Returns pointers to supported interfaces.</div></div>
<div class="ttc" id="aa02113_html"><div class="ttname"><a href="a02113.html">AAX_IEffectParameters</a></div><div class="ttdoc">The interface for an AAX Plug-in's data model.</div><div class="ttdef"><b>Definition:</b> AAX_IEffectParameters.h:83</div></div>
</div><!-- fragment --><h1><a class="anchor" id="ACF"></a>
Interface versioning in AAX</h1>
<p>The ACF-based interface used by AAX is designed to allow additional features to be added to the architecture. This can be achieved via the addition of new kinds of interfaces (e.g. <a class="el" href="a02105.html">AAX_IEffectDirectData</a>) or by extending the existing interfaces. In this section, we will describe an approach for interface extension.</p>
<p>First, here is a more complete picture of "version 1" of the <a class="el" href="a01953.html">AAX_IACFEffectParameters</a> and <a class="el" href="a01917.html">AAX_IACFController</a> interfaces, including a possible host implementation of <a class="el" href="a01917.html">AAX_IACFController</a> :</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_aax_acf_versioning_full.svg" width="771" height="619"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
ACF interfaces: AAX_IACFEffectParameters and AAX_IACFController (with possible host design)</div>
</div>
</p>
<p>To extend these interfaces, new "version 2" interfaces are created that inherit from the original interface classes. Although any version 1 method could be called on the new version 2 class, references to each interface are retained by the client in order to clarify the specific version in which each method was introduced.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_aax_acf_versioning_plug-in_v2.svg" width="536" height="740"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
Adding a new version to AAX_IACFEffectParameters and AAX_IACFController</div>
</div>
</p>
<p>In this example, if the plug-in is loaded by an older host, the reference to <code>AAX_IACFControllerV2</code> will return as <code>NULL</code>, and calls to the V2 methods in <a class="el" href="a02077.html">AAX_IController</a> will return an "unimplemented" error code. Similarly, if a plug-in that only implements <a class="el" href="a01953.html">AAX_IACFEffectParameters</a> is loaded into a host that supports <code>AAX_IACFEffectParametersV2</code>, that host will receive a <code>NULL</code> reference to the newer interface version and will only be able to call methods on the plug-in's implementation of the original interface.</p>
<p>As a final example, here is a possible design involving new versions of both <a class="el" href="a01953.html">AAX_IACFEffectParameters</a> and <a class="el" href="a01917.html">AAX_IACFController</a>, with an example design for the host's implementation as well as the plug-in's:</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_aax_acf_versioning_full_v2.svg" width="1003" height="740"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe><div class="caption">
Complete design example with versioned ACF interfaces</div>
</div>
 </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Documents</h2></td></tr>
<tr class="memitem:a00844"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00844.html">ACF Elements</a></td></tr>
<tr class="memdesc:a00844"><td class="mdescLeft">&#160;</td><td class="mdescRight">ACF classes that are used by common AAX interfaces. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<div class="dynheader">
Collaboration diagram for The Avid Component Framework (ACF):</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00843.svg" width="479" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div><!-- contents -->
<!--        Copyright 2016, 2018, 2021 by Avid Technology, Inc.        -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
    <div class="FooterLegal">© 2021 Avid Technology, Inc. All rights reserved.</div>
    <div class="FooterLegal">This product may be protected by one or more U.S. and non-U.S. patents. Details are available at <a href="https://www.avid.com/patents">www.avid.com/patents</a>.</div>
Generated on Wed Aug 25 2021 15:29:27 for AAX SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
</body>
</html>
